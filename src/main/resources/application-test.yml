spring:
  kafka:
    # Use 'localhost:9092' as a dummy, Testcontainers will override this dynamically
    bootstrap-servers: localhost:9092
    admin:
      auto-create: false
      fail-fast: false
    streams:
      # Prevents the Stream thread from trying to connect to localhost during boot
      auto-startup: false
    properties:
      # These ensure Spring doesn't hang if Kafka takes a few seconds to boot in Docker
      request.timeout.ms: 2000
      default.api.timeout.ms: 2000
    producer:
      properties:
        max.block.ms: 5000

# Keep your existing Resilience4j logic but maybe tighten the window for faster tests
resilience4j:
  circuitbreaker:
    instances:
      kafkaProducer:
        registerHealthIndicator: true
        slidingWindowSize: 5
        minimumNumberOfCalls: 3
        waitDurationInOpenState: 2s
        failureRateThreshold: 50